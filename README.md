# Phaser 3 tutorial

## Environment

- Editor: VSCode
    - Extensions:
        - ESLint
        - Prettier ESLint
        - Live Server
- Node.js: `14.17.5`
    - npm: `6.14.14`
    - yarn: `1.22.11`

***

## Setup: Phaser 3 + TypeScript + Webpack development environment

### Setup: Phaser 3
```bash
# install phaser
$ yarn add phaser
```

### Setup: TypeScript + Webpack
```bash
# install typescript, webpack
$ yarn add -D typescript webpack webpack-cli ts-loader expose-loader
```

- New file like below: `tsconfig.json`

```json:tsconfig.json
{
  "compilerOptions": {
    "target": "ES6",
    "module": "commonjs",
    "sourceMap": true,
    "noImplicitAny": false,
    "strict": false
  }
}
```

- New file like below: `webpack.config.js`

```javascript:webpack.config.js
const pathToPhaser = `${__dirname}/node_modules/phaser/`;
const phaser = `${pathToPhaser}/public/js/phaser.js`;

module.exports = {
  entry: `${__dirname}/src/app.ts`,
  output: {
    path: `${__dirname}/public/js`,
    filename: 'app.js',
  },
  module: {
    rules: [
      { test: /\.ts$/, loader: 'ts-loader', exclude: '/node_modules/' },
      {
        test: /phaser\.js$/,
        loader: 'expose-loader',
        options: {
          exposes: { globalName: 'Phaser', override: true },
        },
      },
    ],
  },
  resolve: {
    extensions: ['.ts', '.js'],
    alias: {
      phaser: phaser,
    },
  },
};
```

### Setup: ESLint + Prettier
```bash
# install eslint, prettier
$ yarn add -D prettier 
$ yarn add -D eslint eslint-config-prettier eslint-plugin-prettier
$ yarn add -D @typescript-eslint/eslint-plugin @typescript-eslint/parser 
```

- New file like below: `.eslintrc.json`

```json:.eslintrc.json
{
  "parser": "@typescript-eslint/parser",
  "parserOptions": {
    "project": "./tsconfig.json"
  },
  "plugins": ["@typescript-eslint", "prettier"],
  "extends": [
    "plugin:@typescript-eslint/recommended",
    "prettier/@typescript-eslint",
    "plugin:prettier/recommended"
  ],
  "env": {
    "browser": true,
    "node": true,
    "es6": true
  },
  "rules": {
    "prettier/prettier": "error",
    "no-return-assign": ["off"]
  }
}
```

- New file like below: `.prettierrc`

```json:.prettierrc
{
  "trailingComma": "all",
  "tabWidth": 2,
  "semi": true,
  "singleQuote": true
}
```

### Configure: VSCode Live Server
- New file like below: `./.vscode/settings.json`

```json:./.vscode/settings.json
{
  // Live Server root directory: ./public/
  "liveServer.settings.root": "/public/"
}
```

### Structure
```bash
./
|_ .vscode/ # vscode configurations
|  |_ settings.json # vscode configuration file
|
|_ public/ # server base path
|  |_ js/
|  |  |_ (app.js) # main javascript file: will be generated by webpack
|  |
|  |_ index.html # top page
|
|_ src/ # typescript source codes
|  |_ app.ts # main typescript source code
|
|_ .eslintrc.json # eslint configuration file
|_ .prettierrc # prettier configuration file
|_ tsconfig.json # typescript compiler configuration file
|_ webpack.config.js # webpack configuration file
```

***

## HelloWorld

### public/index.html
- New file like below: `./public/index.html`

```html:./public/index.html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title>TutorialMaking your first Phaser 3 Game</title>
    <style>
      body {
        margin: 0;
      }
    </style>
    <script src="/js/app.js" ></script>
  </head>
  <body>
    <div id="game"></div>
  </body>
</html>
```

### src/app.ts
- New file like below: `./src/app.ts`

```typescript:./src/app.ts
import 'phaser';
import MainScene from './scenes/main';

const config: Phaser.Types.Core.GameConfig = {
  width: 800,
  height: 600,
  type: Phaser.AUTO,
  physics: {
    default: 'arcade',
    arcade: {
      gravity: { y: 200 }
    },
  },
  scene: MainScene,
};

window.addEventListener('load', () => {
  const game = new Phaser.Game(config);
});
```

### src/scenes/main.ts
- New file like below: `./src/scenes/main.ts`

```typescript:./src/scenes/main.ts
export default class MainScene extends Phaser.Scene {
  constructor() {
    super({
      key: 'Main',
      physics: {
        arcade: {
          gravity: { y: 300 }
        }
      }
    });
  }

  preload(): void {
    this.load.image('sky', 'assets/sky.png');
  }

  create(): void {
    this.add.image(400, 300, 'sky');
  }

  update(): void {
    //
  }
}
```

### Launch Webpack
```bash
# launch webpack in file-watching mode
$ yarn webpack --watch
```

### Launch Live Server
- In VSCode: `Alt` + `L` |> `Alt` + `O`
    - => Launch Live Server: http://localhost:5500
